%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MIT License
%
% Copyright (c) 2021 Dylan Jacob Gormley
%
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
%
% The above copyright notice and this permission notice shall be included in all
% copies or substantial portions of the Software.
%
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
% SOFTWARE.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% preamble
\documentclass[12pt]{report} % csu font size

% intert title and name here to be reused throughout document
\title{A Thesis Title}
\author{First M.I. Last}

% appendices setup
\usepackage{multicol, acronym} % remove if not using acronym/nomenclature in appendix
\usepackage[table, dvipsnames]{xcolor} % remove if not putting code in appendix
  \definecolor{dkgreen}{rgb}{0.0,  0.6, 0.00}
  \definecolor{gray}   {rgb}{0.5,  0.5, 0.50}
  \definecolor{mauve}  {rgb}{0.58, 0.0, 0.82}
\usepackage{listings} % remove if not putting code in appendix
  \lstset{
    frame             = tb,
  	language          = Matlab,
  	aboveskip         = 3mm,
  	belowskip         = 3mm,
  	showstringspaces  = false,
  	columns           = flexible,
  	basicstyle        = {\small\ttfamily},
  	numbers           = none,
  	numberstyle       = \tiny\color{gray},
  	keywordstyle      = \color{blue},
  	commentstyle      = \color{dkgreen},
  	stringstyle       = \color{mauve}, 	 
  	breaklines        = true,
  	breakatwhitespace = true,
  	tabsize           = 3
  }


% csu page formatting
\usepackage[doublespacing]{setspace} % csu spacing
\usepackage[ % csu margins
  left   = 1.5in,
  top    = 1in,
  bottom = 1in,
  right  = 1in
  ]{geometry}

% override default toc title with csu formatting
\usepackage{tocloft}
\renewcommand*{\cftchapfont}{\normalfont}  
\renewcommand{\cftchapleader}{\cftdotfill{\cftsecdotsep}}
\setlength{\cftbeforetoctitleskip}{-3em}
\setlength{\cftaftertoctitleskip}{0em}
\renewcommand{\cfttoctitlefont}{\normalfont}
\renewcommand{\contentsname}{
  \begin{center}
  TABLE OF CONTENTS
  \end{center}
  }

% override default lot title with csu formatting
\setlength{\cftbeforelottitleskip}{-3em}
\setlength{\cftafterlottitleskip}{0em}
\renewcommand{\cftlottitlefont}{\normalfont}
\renewcommand{\listtablename}{
  \begin{center}
  LIST OF TABLES
  \end{center}
  }

% override default lof title with csu formatting
\setlength{\cftbeforeloftitleskip}{-3em}
\setlength{\cftafterloftitleskip}{0em}
\renewcommand{\cftloftitlefont}{\normalfont}
\renewcommand{\listfigurename}{
  \begin{center}
  LIST OF FIGURES
  \end{center}  
  }

% override default bibliography title with csu format
\usepackage{natbib}
  \bibliographystyle{unsrtnat}
\newcommand{\mybibname}{REFERENCES}
\renewcommand\bibsection{%
   \clearpage
   \center\noindent\normalsize\MakeUppercase{\mybibname}%
   \markboth{\MakeUppercase{\mybibname}}{\MakeUppercase{\mybibname}}%
  }

\begin{document}
\makeatletter

% frontmatter
\newpage
\pagenumbering{roman}
\input{../sections/titlepage}
\input{../sections/copyright}
\input{../sections/approval}
\input{../sections/dedication}
\input{../sections/acknowledgment}

\addtocontents{toc}{~\hfill Page \par}
\input{../sections/abstract}

\newpage
\tableofcontents

\newpage
\addcontentsline{toc}{chapter}{LIST OF TABLES}
\addtocontents{lot}{Tables ~\hfill Page \par}
\listoftables

\newpage
\addcontentsline{toc}{chapter}{LIST OF FIGURES}
\addtocontents{lof}{Figures ~\hfill Page \par}
\listoffigures

% mainmatter
\newpage
\pagenumbering{arabic}

\cftlocalchange{toc}{360pt}{0cm} % turn off leaders
  \cftaddtitleline{toc}{chapter}{CHAPTERS}{}
\cftlocalchange{toc}{1.55em}{2.55em} % turn on leaders

\input{../sections/chapter_i}

% backmatter
\newpage
\addcontentsline{toc}{chapter}{REFERENCES}
\bibliography{../sections/references}

\newpage
\cftlocalchange{toc}{360pt}{0cm} % turn off leaders
\cftaddtitleline{toc}{chapter}{APPENDICES}{}
\cftlocalchange{toc}{1.55em}{2.55em} % turn on leaders
\input{../sections/appendix_a}
\input{../sections/appendix_b}
\input{../sections/appendix_c}

\end{document}